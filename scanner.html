<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scanner VIN Simplifié</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        #video { width: 100%; max-width: 500px; border: 3px solid #333; }
        button { padding: 12px 24px; font-size: 18px; margin: 10px; }
        #result { font-size: 20px; margin: 20px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Scanner VIN</h1>
    <video id="video" playsinline></video>
    <div>
        <button id="startBtn">ACTIVER LA CAMÉRA</button>
        <button id="stopBtn" disabled>ARRÊTER</button>
    </div>
    <div id="result"></div>

    <script>
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const video = document.getElementById('video');
        const result = document.getElementById('result');

        // 1. Démarrer la caméra (fonction garantie)
        startBtn.onclick = async () => {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: 'environment' } 
                });
                video.srcObject = stream;
                video.play();
                startBtn.disabled = true;
                stopBtn.disabled = false;
                result.textContent = "Caméra activée - Pointez vers un VIN";
            } catch (err) {
                result.textContent = "ERREUR : " + err.message;
            }
        };

        // 2. Arrêter la caméra
        stopBtn.onclick = () => {
            video.srcObject.getTracks().forEach(track => track.stop());
            startBtn.disabled = false;
            stopBtn.disabled = true;
            result.textContent = "Caméra arrêtée";
        };

        // 3. Simulation de détection (à remplacer par un vrai scanner)
        setTimeout(() => {
            if (video.srcObject) {
                result.innerHTML = '<span style="color:green">VIN DÉTECTÉ (simulation) :<br>1HGCM82633A123456</span>';
            }
        }, 3000);
    </script>
</body>
</html>
